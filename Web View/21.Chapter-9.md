## _Chapter #9_

# ***An Introduction to the Technical Side of Bitcoin***

- [**9.0** Introduction](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#90-introduction)    
  - [**Activity:** Watch ‚ÄúHow Bitcoin Works Under the Hood‚Äù](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#activity-watch-how-bitcoin-works-under-the-hood)    
- [**9.1** Public and Private Keys: Security through Cryptography](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#91-public-and-private-keys-security-through-cryptography)    
  - [**9.1.1** Cryptography Public/Private Keys](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#911-cryptography-publicprivate-keys)    
  - [**9.1.2** Hashing Explanation](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#912-hashing-explanation)
  - [**Activity:** Generate SHA 256 Hash](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#activity-generate-sha-256-hash)    
- [**9.2** The UTXO Model](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#92-the-utxo-model)    
- [**9.3** Bitcoin Nodes and Miners](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#93-a-closer-look-at-bitcoin-nodes-and-miners)
  - [**9.3.1** What is a Bitcoin Node and How Do I Set One Up?](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#931-what-is-a-bitcoin-node-and-how-do-i-set-one-up)    
  - [**Activity:** Watch Video on Bitcoin Nodes](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#activity-watch-video-on-bitcoin-nodes)
  - [**9.3.2** What is a Bitcoin Miner and How Does Mining Work?](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#932-what-is-a-bitcoin-miner-and-how-does-mining-work)    
- [**9.4** What is the Mempool?](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#94-what-is-the-mempool)    
  - [**Activity:** Mempool](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#activity-mempool)    
- [**9.5** How Bitcoin Transactions Work from Start to Finish](https://github.com/MyFirstBitcoin/Bitcoin-Diploma-2024/blob/main/Web%20View/21.Chapter-9.md#95-how-bitcoin-transactions-work-from-start-to-finish)

<br/>

______________________________________________________________________________________________________

### ***9.0 Introduction***    

> "Bitcoin is not ‚Äúunregulated‚Äù; it is regulated by algorithm instead of being regulated by government bureaucracies. Un-corrupted.‚Äù    
 **$\color[RGB]{250,175,64} Andreas \ M. \ Antonopoulos$**

<br/>

In this chapter, we will take a closer look at the technology that enables the Bitcoin network to operate in a fully decentralized way. We will explain in simple terms what happens when you send a bitcoin transaction, how those transactions are processed, and what miners and nodes do in the Bitcoin network. We are going to cover some challenging and technical concepts in this chapter. One thing important thing to remember: many people don‚Äôt understand how the internet works, yet they are able to use it every day to send emails, contact friends on social media, and even pay their bills. Learning the technical side of how Bitcoin works is a long journey that not everyone may want to take, even if they decide to use it as money. While we do encourage you to keep learning about the technical aspects of Bitcoin, we will keep this chapter focused on basic key concepts.

<div><p align="center"><img src="Images/19.Chapter-9/10.Introduction-v1.png" width="850"></div>

- If you want a deeper technical understanding of how Bitcoin works, we have included resources in the back of this workbook. You can also register on our website for the Bitcoin Diploma - Technical Edition to be notified when this more technical course is ready.

Let‚Äôs jump in by watching a video that shows how the Bitcoin network works.

<br/>
<br/>

### _Activity: Watch ‚ÄúHow Bitcoin Works under the Hood‚Äù_

<div><p align="center"><a rel="YouTube video of -- How Bitcoin Works Under the Hood" href="https://www.youtube.com/watch?v=Lx9zgZCMqXE"><img src="Images/19.Chapter-9/11.Activity-How-Bitcoin-works-under-the-hood-v1.png" width="180"></div>

As you saw in the video, the Bitcoin network is simply a ledger or record of transactions stored on multiple computers called nodes. The Bitcoin ledger is pseudonymous, meaning it doesn't have personal details, only transaction and address information. The ledger shows every bitcoin and its movements since the network started on January 3rd, 2009.

Next we‚Äôll take a closer look at the technology that makes this system possible.

<br/>
<br/>

### ***9.1 Public and Private Keys: Security through Cryptography***    

> "What Bitcoin gives us is a hard promise: the program will execute exactly as specified.‚Äù    
 **$\color[RGB]{250,175,64} Andreas \ M. \ Antonopoulos$**

<br/>
<br/>

### _9.1.1 Cryptography Public/Private Keys_

<div><p align="center"><img src="Images/19.Chapter-9/12.Cryptography-v1.png" width="435"></div>

- ‚≠ê Encryption is the process of taking information and transforming it in a special code, making it unreadable to anyone who does not have the correct decryption method. This is similar to locking a safe, where only the person with the correct key or combination can open it.

- ‚≠ê Decryption, on the other hand, is the process of taking the encrypted information and making it readable again, like unlocking the safe and being able to read the information inside.

<br/>

For instance, let‚Äôs say John wants to send Arel a secret message that isn‚Äôt meant for anyone else to read. They agree to use the Pigpen Cipher encryption method to disguise the message before sending it. Only those with the cipher can decrypt the message, making it unreadable to anyone else. Though this method is not considered secure today, it does illustrate the principle of private-key cryptography to send messages.

| **How to Solve** <br> Pigpen Cipher |
| :---------: |
| When solving the Pigpen Cipher, <br> the player is given an encrypted <br> message and a cipher. To decrypt <br> the message, the player will find <br> the symbol from the encrypted <br> message on the cipher to find the <br> decrypted letter. <br> <br> - ‚≠ê Example of an encrypted message: <br> <br> <div><p align="center"><img src="Images/19.Chapter-9/13.Pigpen-Cipher-v1.png" width="350"></div> |

<br/>

**So, how does cryptography work in bitcoin transactions?**

In traditional private-key cryptography, John and Arel would have to first share a secret key, like a password or the Pigpen Cipher. John would then use this key to encrypt his message before sending it to Arel. Arel, who also knows the secret key, would then use the same key to decrypt the message and read it.

However, if someone else is in possession of the key and intercepts the message, they could decrypt it and read it.

<br/>

Public key cryptography, the type used in bitcoin transactions, has solved this problem. With public key cryptography, John and Arel don‚Äôt need to share the password or encryption method with each other. Instead, they each have two different keys: a **$\color[RGB]{104,59,147} public \ key$** (which is safe to share with anyone) and a **$\color[RGB]{255,166,21} private \ key$** (which should be kept private).

In this case, when John wants to send a message to Arel, he can use Arel‚Äôs **$\color[RGB]{104,59,147} public \ key$** to encrypt his own message before sending it to Arel. When Arel receives the message, only he is able to decrypt it with his **$\color[RGB]{255,166,21} private \ key$**. Anybody else, even if they intercept the message, would not be able to read the message. Chances are also much lower to steal the key because even John and Arel don‚Äôt need to share the key with each other.

<div><p align="center"><img src="Images/19.Chapter-9/14.Bitcoin-users-and-the-Bitcoin-network-v1.png" width="420"></div>

<br/>

So, the main advantage of public key cryptography over private is that it allows for secure communication without the need for the sender and receiver to first share a secret key (or another encryption method like Pigpen Cipher), which could be intercepted by a third party.

In Bitcoin, public key cryptography is not used to send encrypted messages. Instead, it is used to create unique **$\color[RGB]{31,110,199} digital \ signatures$** that make bitcoin transactions immutable. A **$\color[RGB]{31,110,199} digital \ signature$** is a way to prove the authenticity of a bitcoin transaction, in some way similar to when you write your signature on a physical document.

<br/>

- üí° **Public Key Cryptography (for every transaction between two users):** <br> <br> Each user has two keys; a **$\color[RGB]{255,166,21} private \ key$**, which is **$\color[RGB]{255,166,21} kept \ secret$**, and a **$\color[RGB]{104,59,147} public \ key$** that can be **$\color[RGB]{104,59,147} shared \ with \ others$**. <br> <br> The **$\color[RGB]{255,166,21} private \ key$** serves as a form of identification and proof of ownership, confirming: **‚ÄúThis address belongs to me and I have control over it.‚Äù** <br> <br> **$\color[RGB]{31,110,199} Digital \ signatures$** are created to identify unique transactions.

<div><p align="center"><img src="Images/19.Chapter-9/15.Digital-signature-v1.png" width="420"></div>

<br/>

- ‚≠ê Bitcoin transactions involve transferring a certain amount of bitcoins directly to another person‚Äôs account.

- ‚≠ê that only the real holder of the bitcoins has the control to send their money to someone else. It makes sure that the property is guarded from malicious actors.

- ‚≠ê As an additional measure of protection, each transaction that you send in Bitcoin automatically gets a **$\color[RGB]{31,110,199} UNIQUE \ signature$**. This **$\color[RGB]{31,110,199} unique \ signature$** is empowered by tamper-proof technology that helps the network verify that the real owner of the bitcoins, and not someone else, has sent them.

<div><p align="center"><img src="Images/19.Chapter-9/16.Bitcoin-transaction-with-a-signature-example-v1.png" width="420"></div>

How this works in a real bitcoin transaction in simple terms:

1. ‚≠ê **Creating the Transaction:** <br>
    A user initiates a bitcoin transaction by specifying details such as the recipient's address and the amount of bitcoins to be sent.

2. ‚≠ê **Digital Signature Generation:** <br>
    The sender generates a unique **$\color[RGB]{31,110,199} digital \ signature$** using their **$\color[RGB]{255,166,21} private \ key$**. This signature is a unique cryptographic code that verifies the authenticity of the transaction.

3. ‚≠ê **Broadcasting the Transaction:** <br>
    The signed transaction is broadcasted to the Bitcoin network, indicating the intent to transfer ownership of bitcoins from the sender to the recipient.

4. ‚≠ê **Verification on the Network:** <br>
    Nodes on the Bitcoin network receive the transaction and use the **$\color[RGB]{104,59,147} public \ key$** of the recipient to decrypt and verify the integrity of the transaction. Simultaneously, they use the sender's **$\color[RGB]{104,59,147} public \ key$** to verify the **$\color[RGB]{31,110,199} digital \ signature$**.

5. ‚≠ê **Confirmation on the Bitcoin network:** <br>
    If the verification is successful, the transaction will be added to the ledger, which serves as a secure, transparent record of all transactions. Once confirmed, the ownership of the bitcoins is officially transferred from the sender to the recipient.

<div><p align="center"><img src="Images/19.Chapter-9/17.Satoshi-is-creating-a-transaction-v1.png" width="280"></div>

In summary, the digital signature, created with the sender's private key, serves as cryptographic proof of authenticity and ownership, allowing Bitcoin‚Äôs decentralized network to validate and record the transaction on the ledger.

<br/>
<br/>

### _9.1.2 Hashing Explanation_

Please don‚Äôt be intimidated by the technical terms and mathematical concepts ahead. We understand that not everyone is crazy about math, but you might surprise yourself and see that even the most complex ideas can be grasped with a little bit of effort.

**What is a function?**

- üí° A **function** is like a machine that takes some information and turns it into something new. The information you give the function is called the **$\color[RGB]{255,166,21} input$**. The new information the function creates is called an **$\color[RGB]{31,110,199} output$**. Functions help computers do tasks and solve problems.

<div><p align="center"><img src="Images/19.Chapter-9/18.Function-machine-v1.png" width="340"></div>

<br/>

Think of it like a recipe for making a salad. The recipe (or function) tells you what ingredients to use and how to mix them together to make the salad. You can put different ingredients in, but the recipe will always give you the salad as the output. Functions can be used to help make things easier and more efficient.

This recipe is a function that takes the ingredients as the **$\color[RGB]{255,166,21} input$** and generates the tossed salad as the **$\color[RGB]{31,110,199} output$**.

In Bitcoin, functions are utilized to execute transactions. We already know that transactions in bitcoin are essentially transfers of value (money) from one address to another. To perform a transaction, a number of cryptographic functions are used to validate the transaction and update the state of Bitcoin‚Äôs ledger.

<div><p align="center"><img src="Images/19.Chapter-9/19.Salad-as-a-form-of-a-function-v1.png" width="440"></div>

The functions used in a bitcoin transaction include verifying the authenticity of the transaction inputs, checking that the sender has sufficient funds, and updating the balances of the relevant addresses. Once a transaction is verified and added to a block in the ledger, it becomes part of the permanent record of all transactions on the network.

<br/>

**What is a one-way function?**

A one-way function uses a set of instructions to process the information and turns it into something new, like a smoothie recipe turns ingredients into a new drink. But, just as you can‚Äôt un-blend a smoothie to get the original ingredients back, you can‚Äôt reverse the one-way function to get the original information back.

<div><p align="center"><img src="Images/19.Chapter-9/20.An-example-of-one-way-function-v1.png" width="350"></div>

<br/>

Public-key cryptography, of which the **$\color[RGB]{104,59,147} public \ key$** is a part of, relies on the use of one-way functions, which make it difficult to determine the **$\color[RGB]{255,166,21} private \ key$** from the **$\color[RGB]{104,59,147} public \ key$**. In theory, it is not exactly ‚Äúimpossible‚Äù to find the **$\color[RGB]{255,166,21} private \ key$** from the **$\color[RGB]{104,59,147} public \ key$**, but it is extremely difficult to do so and would take an inordinate amount of time and computational power to accomplish this task.

Finding a **$\color[RGB]{255,166,21} private \ key$** from a **$\color[RGB]{104,59,147} public \ key$** in Bitcoin is like trying to find a needle in a haystack as large as a football field. The needle represents the **$\color[RGB]{255,166,21} private \ key$** and the haystack represents all the possible **$\color[RGB]{255,166,21} private \ keys$**.

In the same way, one-way functions are designed to be irreversible and cannot be decrypted.

<div><p align="center"><img src="Images/19.Chapter-9/21.Finding-a-private-key-is-like-searching-a-needle-in-a-haystack-v1.png" width="350"></div>

<br/>

**What is a hash function?**

- üí° **Hashing** is like a fingerprint for digital data. It is a process of taking a digital message and turning it into a fixed length code, which serves as a unique identifier.

Just like a fingerprint can identify a person, a hash can identify a digital message. Hashes are used in many applications, including bitcoin transactions.

**How hashing is used in bitcoin transactions**

In Bitcoin, every transaction is hashed before it is added to a block in the ledger. The hash acts as a signature for the transaction, verifying that the transaction is valid and has not been tampered with. If someone tries to change even a single letter in the transaction, the hash will be completely different, alerting others to the change.

**The role of hashing in providing security**

Hashing is essential to the security of the Bitcoin network. By using hashes to identify transactions, the network can detect any attempt to change or manipulate a transaction. This helps to prevent fraud and ensure that all transactions are recorded accurately on the ledger.

A hash function is a type of one-way function that takes an input (referred to as the ‚Äúmessage‚Äù or ‚Äúdata‚Äù) and converts it into a numerical representation referred to as a ‚Äúhash.‚Äù The **$\color[RGB]{31,110,199} output$** hash is unique to the input data, so even a small change in the **$\color[RGB]{87,88,91} input$** data results in a completely different hash.

<div><p align="center"><img src="Images/19.Chapter-9/22.How-a-hash-function-works-v1.png" width="450"></div>

- üí° **A hash function** is like a secret code machine. It takes in a **$\color[RGB]{255,166,21} message$** and turns it into a code.

<br/>
<br/>

### _Activity: Generate SHA 256 Hash_

<div><p align="center"><a rel="Website of -- SHA256 Generator" href="https://tools.keycdn.com/sha256-online-generator"><img src="Images/19.Chapter-9/23.Generating-a-SHA-256-Hash-v1.png" width="750"></div>

The **$\color[RGB]{31,110,199} output$**, or hash, is always the same length, no matter how long the original information was.

Bitcoin uses a few specific types of hash function called **SHA-256** and **RIPEMD160**. A few examples are below:

- ‚≠ê Notice that a small change in the second input changes the output completely when compared to the first one.

- ‚≠ê The third input is a huge file yet the output is still the same fixed length as the other two.

**Hashing** can also be thought of as a musical score that captures the essence of a piece of music. Just as a musical score is a unique representation of a tune, a hash value is a unique representation of a piece of data. By comparing the score of a piece of music with the actual performance, a musician can determine if the performance is accurate. Similarly, by comparing the hash value of received data with the original hash value, one can determine if the data has been altered during transmission.

<div><p align="center"><img src="Images/19.Chapter-9/24.A-small-change-a-different-result-v1.png" width="600"></div>

<br/>

Just as a slight deviation in a musical performance can cause it to sound different, even the slightest change to the original data will result in a different hash value. This makes hashing a powerful tool for ensuring the integrity and authenticity of a bitcoin transaction.

The process of encoding the **$\color[RGB]{104,59,147} public \ key$** through hashing is used to improve the security of information by converting it into a fixed-length, unreadable format. Bitcoin uses the SHA-256 and Ripemd-160 algorithms to produce public addresses. The resulting output serves as a unique identifier for the **$\color[RGB]{104,59,147} public \ key$** and helps to ensure the integrity and security of transactions stored in the ledger. By encrypting the information in this way, it becomes more difficult for unauthorized individuals to access and manipulate the data.

<div><p align="center"><a rel="Website of -- another hash Generator" href="https://www.bitcoinsimulator.tk/explanation?page=10"><img src="Images/19.Chapter-9/25.Another-hash-generator-v1.png" width="480"></div>

<br/>

<div><p align="center"><img src="Images/19.Chapter-9/26.A-simple-example-of-a-hash-function-v1.png" width="480"></div>

- ‚≠ê **Deterministic.** <br>
   The same ingredients always yield the same smoothie.

- ‚≠ê **Pre-Image Resistance.** <br>
   You can‚Äôt glue together a strawberry when given a smoothie.

- ‚≠ê **Correlation Resistance.** <br>
   Changing the ingredients a little results in a completely different smoothie.

- ‚≠ê **Collision Resistance.** <br>
   It‚Äôs hard to find different ingredients for a smoothie that result in the exact same one.

- ‚≠ê **Speed & Verifiablility.** <br>
   Throw fruit into the mixer. It‚Äôs fast and what comes out for sure is a smoothe.

<br/>
<br/>

### ***9.2 The UTXO Model***    

- üí° **UTXO - Unspent Transaction Output**

<br/>

**What are UTXOs?**

In Bitcoin, transactions work like breaking a bigger piece of gold into smaller pieces and sending these smaller pieces both to others and to yourself.

You can think of UTXOs as different sizes and pieces of bitcoin or differently denominated bills in your wallet. When you spend a UTXO, it is recreated into a new UTXO for the receiver, and whatever is left over is sent back to you in a different new UTXO known as ‚Äúthe change UTXO.‚Äù This is much like using a $10 bill to buy two cups of coffee for $6. The coffee shop keeps the $6 piece and hands you $4 in change.

<div><p align="center"><img src="Images/19.Chapter-9/27.A-simple-UTXO-v1.png" width="380"></div>

When sending bitcoins, you always send the entire amount of one (or more) of your UTXOs in your Bitcoin wallet. What happens? You send a piece to the recipient, and you receive the remaining amount back as change to one of your new Bitcoin addresses. The change you receive is called an unspent transaction output, or UTXO, and can be used as an input for a new future transaction.

The balance of your Bitcoin wallet is the sum of all your different UTXOs. So, the sum of your UTXOs is the sum of the amount of bitcoins you own.

<br/>

- üí° It is important to note that you should not make others aware of your UTXOs because when someone knows them, they can track your bitcoin transactions in the network and will ultimately know how much money you own.

<br/>

In conclusion, each time you make a transaction, you use one or more of your existing UTXOs to spend bitcoins and new UTXOs are created (for both you as the recipient).

<div><p align="center"><img src="Images/19.Chapter-9/28.UTXO-in-detail-v1.png" width="820"></div>

When a transaction is made, the amount of bitcoins sent are divided into multiple outputs, each of which are associated with a new Bitcoin address (a new UTXO).

<br/>

When sending bitcoins to someone, you will use one or more UTXOs as the source of the funds (input). These UTXOs will be combined, if necessary, to create new outputs that belong to both the recipient of the transaction and yourself. These new outputs, or UTXOs, will become the recipient‚Äôs property and your property. These UTXOs can then be used as the source of funds in other future transactions. This chain of UTXOs creates a transparent, traceable history of all bitcoin transactions on Bitcoin‚Äôs ledger, starting from the very first block (January 3rd, 2009).

An example to illustrate how this works: if you want to send two bitcoins but you only have a UTXO worth five bitcoins, the difference of three bitcoins is sent back to you as ‚Äúchange.‚Äù This change is a new UTXO for you, and you can spend that new UTXO in a future transaction.

Another example:
1. ‚≠ê Alice wants to send Bob five bitcoins.
2. ‚≠ê She combines six bitcoins from two of her UTXOs
3. ‚≠ê From these UTXOs, she sends five bitcoins to Bob, gets 0.99 bitcoins as change back to herself, and needs to pay a 0.01 transaction fee.
4. ‚≠ê After confirmation, the transaction is added to Bitcoin‚Äôs ledger, updating all the nodes that have a copy of the ledger.

<div><p align="center"><img src="Images/19.Chapter-9/29.Simplified-example-of-a-UTXO-v1.png" width="380"></div>

If Alice attempts to use one of her already spent outputs to make another transaction, it would automatically be rejected by the nodes. This is because the nodes maintain a copy of Bitcoin‚Äôs ledger (and all its transactions), so they can easily check the balance of Alice‚Äôs UTXOs and verify that the transaction is not valid.

Below is an actual screenshot of a real transaction where there is only one input. However, the starting balance could, in another case, be the sum of multiple UTXOs (multiple inputs). What observations can you make when you look at the two transactions below? Do the inputs match the outputs? Can you describe the details of the transaction? Is there a connection between the two screenshots? And which transaction occurred first?

<div><p align="center"><img src="Images/19.Chapter-9/30.UTXOs-on-chain-v1.png" width="850"></div>

<br/>
<br/>

### ***9.3 A Closer Look at Bitcoin Nodes and Miners***    

In this section, we‚Äôll take a more detailed look at two very important parts (and participants) of the Bitcoin network that were first introduced in Chapter 6. We‚Äôll look at:

1. ‚≠ê **Bitcoin Nodes:** <br>
    Gatekeepers of Validation whose main job is to keep a copy of Bitcoin‚Äôs ledger, make sure that all transactions are valid, and that everyone follows the same rules. <br> <br>
    By spreading out this job among many people worldwide, Bitcoin stays strong against potential problems. These nodes help keep the system trustworthy and true to its decentralized idea, where no one person or group has too much power.

2. ‚≠ê **Bitcoin Miners:** <br>
    Architects of Security that use powerful computers and electricity to check and confirm transactions, making sure everything is secure. This work helps make the ledger, or blockchain, resistant to any bad actors trying to mess things up.

Together, Bitcoin nodes and miners work as a team to maintain a decentralized, secure, and strong system‚Äîa new way of handling money that people all around the world can rely on. Let's explore these roles in more detail to understand how they contribute to the innovative Bitcoin system.

<br/>
<br/>

### _9.3.1 What is a Bitcoin Node and How Do I Set One Up?_

A Bitcoin node may sound technical but it is just a piece of software which runs a copy of the Bitcoin ledger. When you run your own Bitcoin node, you gain a voice in shaping the rules of the Bitcoin network.

Imagine this: if a group of people attempts to change how Bitcoin functions, say by altering the total supply of bitcoins, you have a say. You can choose not to change your node to the new system, which is like voting to enforce the rules of the network you support.

<div><p align="center"><img src="Images/19.Chapter-9/31.Example-of-Bitcoin-nodes-v1.png" width="650"></div>

<br/>

Let‚Äôs imagine a Bitcoin node as a digital traffic cop with some essential tasks:

1. ‚≠ê **Gatekeepers of Validation:** <br>
    A Bitcoin node keeps a digital copy of the blockchain, which is like a shared ledger of all bitcoin transactions. Many nodes around the world hold this same record.

2. ‚≠ê **Communication Hub:** <br>
    Nodes connect with each other, creating a vast communication network. They share information, especially transactions waiting to be added to the blockchain, stored in a digital waiting room called ‚Äúthe mempool."

3. ‚≠ê **Quality Checker:** <br>
    Every addition to the blockchain undergoes scrutiny. Nodes ensure that transactions are valid, rejecting any that don't meet the rules of the Bitcoin network.

4. ‚≠ê **Blockchain Informant:** <br>
    Other software, like wallets, can ask a node for information about the blockchain, such as bitcoin balances. Nodes serve as information hubs.

5. ‚≠ê **New Node Welcomer:** <br>
    When a new node wants to join, existing nodes generously provide a copy of the blockchain. The new node independently checks the validity of each transaction, emphasizing a trustless system.

<br/>
<br/>

### _Activity: Watch video on Bitcoin Nodes_

<div><p align="center"><a rel="Website of -- Bitcoin Nodes" href="https://www.youtube.com/watch?v=xc_TxlByxeY"><img src="Images/19.Chapter-9/32.Video-on-Bitcoin-nodes-v1.png" width="160"></div>

One of the options to run your own node is to download the Bitcoin Core software and give it some time to download the entire blockchain. Once ready, you can leave it on and, approximately every 10 minutes, new blocks with transactions arrive. Your node checks their validity, adding them to your local copy of the blockchain.

<br/>

<div><p align="center"><a rel="Website of -- Bitcoin Core software download" href="https://bitcoin.org/en/download/"><img src="Images/19.Chapter-9/33.Resource-Bitcoin-Core-software-v1.png" width="320"></div> 

Running a node provides sovereignty and independence. You don't rely on others; it's your own traffic cop. Unlike your Bitcoin wallet, which lacks a copy of the blockchain, a node ensures self-sufficiency. Instead of trusting others about your bitcoin holdings (and the state of the Bitcoin network), your wallet communicates with your personal node, making your digital experience more secure and trustworthy.

<br/>
<br/>

### _9.3.2. What is a Bitcoin Miner and How Does Mining Work?_

> "The purpose of mining is not the creation of new bitcoin; that‚Äôs the incentive system. Mining is the mechanism by which Bitcoin‚Äôs security is decentralized.‚Äù    
 **$\color[RGB]{250,175,64} Andreas \ M. \ Antonopoulos$**

<br/>

- üí° **Miners** collect unconfirmed transactions, form a block, and expend energy to look for a valuable key that will **add and secure the block‚Äôs spot in the blockchain**.

Miners are in a race to add the next block to the blockchain. The sought-after prize is a ‚Äúvalid block hash,‚Äù cleverly hidden among billions of others, and only a specific key assigned by the network can unlock it.

Picture a massive haystack filled with millions of keys, each representing a unique block hash. The network has chosen one specific key to unlock a valuable reward. Miners rummage through the haystack, testing each key in the lock, but only one lucky miner will discover the perfect match.

Once a miner finds the correct block hash, they share it with the network along with their created block of new transactions. Other miners verify the solution to make sure it‚Äôs the right fit. If everything checks out, the block is added to the blockchain, creating a secure and public ledger.

Miners earn rewards for their efforts in two ways:
1. ‚≠ê Block rewards
2. ‚≠ê Transaction fees

Block rewards are new bitcoin released into circulation with each block added to the blockchain. Transaction fees are small bitcoin payments users make to have their transactions processed faster and prioritized by the miner. Miners can pick which transactions to include in the block they mine, usually giving preference to those with higher transaction fees.

<br/>

**Bitcoin halvings**
A bitcoin halving is an essential part of the Bitcoin universe that helps maintain its scarcity and value over time. As you know, there is a fixed supply of 21,000,000 bitcoins in total. This supply isn‚Äôt fully available from the day Bitcoin launched. Instead, this supply enters the Bitcoin universe in a step-by-step fashion.

Satoshi Nakamoto cleverly designed a block reward system to distribute new bitcoins without a central authority. In Bitcoin‚Äôs early days, miners got a sweet 50 bitcoin reward for each block they mined, motivating them to invest in powerful equipment and electricity for their mining operations.

<div><p align="center"><img src="Images/19.Chapter-9/34.Reward-for-miners-for-completing-1-block-over-time-v1.png" width="450"></div>

To keep the network stable and manage new bitcoin supply, the block reward is halved about every 210,000 blocks. This event, called ‚Äúthe halving,‚Äù decreases the number of new bitcoins entering circulation and continues to motivate miners to protect the network and uphold its decentralization. Historically, halving events have led to significant price increases in the Bi tcoin market due to the reduced supply of new bitcoins making their way into circulation.

<br/>

- üí° **Circulating Supply** refers to the total amount of a currency. With Bitcoin, the total circulating supply is the number of coins that have been mined and are in circulation at any given time, excluding any coins that are lost forever.

During each halving event, miners receive fewer bitcoin rewards, which lowers the issuance rate of new coins. As a result, Bitcoin‚Äôs mining difficulty increases to maintain a block time of approximately 10 minutes, ensuring new blocks are added to the blockchain at a steady pace. The reduction in mining rewards doesn‚Äôt necessarily mean miners make less profit, as they can also earn transaction fees for verifying transactions and adding them to the blockchain, which can offset the decrease in mining rewards.

Halving events are pre-programmed into the Bitcoin protocol, making the supply schedule of bitcoins predictable and transparent.

<div><p align="center"><img src="Images/19.Chapter-9/35.Satoshi-marks-calendar-for-a-halving-event-v1.png" width="300"></div>

- üí° The **Bitcoin supply schedule** is the predetermined and public plan for the release of new bitcoins into circulation, designed to maintain Bitcoin‚Äôs scarcity over time.

The following table outlines the details of upcoming halving events for Bitcoin, including the expected date of the next halving event, the block number at which the halving event will happen, the block rewards (per mined block) during that halving event, and the percentage of the total supply that will be mined.

<div><p align="center"><img src="Images/19.Chapter-9/36.Bitcoin-supply-schedule-v1.png" width="550"></div>

| Event | Expected Date | Block | Block Reward | Percentage Mined |
| :-------------: | :-------------: | :---------: | :---------: | :---------: |
| **Fourth Halving** | 2024 | 840,000 | 3.125 | 96.875 % |
| **Fifth Halving** | 2028 | 1,050,000 | 1.5625 | 98.4375 % |
| **Sixth Halving** | 2032 | 1,260,000 | 0.78125 | 99.21875 % |

As more bitcoins are mined, the circulating supply and the percentage of the total supply that has been mined will keep increasing until the total supply of 21,000,000 is reached. The reduced supply, combined with rising demand, can boost Bitcoin‚Äôs price (measured in dollars). This benefits early adopters and also motivates miners to continue securing the network and contributing their computing power and resources.

<div><p align="center"><img src="Images/19.Chapter-9/37.Percent-of-21M-supply-mined-v1.png" width="650"></div>

<br/>

**What is a valid block hash in Bitcoin?**    
In Bitcoin, a valid block hash is like a special code that miners try to find. It's a unique number that helps keep track of each block in the blockchain that stores information about transactions. The blocks connect in a chain from the first one (genesis block) to the latest, making a public record of all transactions. This block hash is crucial because it links each block to the one before it, making it easy for anyone to check the history of transactions. It's a bit like a fingerprint for each block, ensuring the information is correct and secure. The block hash acts as a way to confirm that the data in the block hasn't been changed.

<div><p align="center"><img src="Images/19.Chapter-9/38.Blocks-linked-with-a-fingerprint-v1.png" width="850"></div>

- Satoshi Nakamoto, the creator of Bitcoin, mined the initial block, which held a total of 50 bitcoins.

<br/>

**The race to mine a block**
Miners engage in a competition to uncover the block hash that aligns with the target (a special number) set by the network. The miner who‚Äôs the first to successfully discover the correct block hash is granted the opportunity to add that block to the blockchain and assign it with the corresponding hash ID. This solution serves as validation for the block‚Äôs authenticity.

Mining can be compared to a race where the goal is to reach the finish line as quickly as possible. How difficult it is to find the block hash is adjusted periodically, ensuring that each block continues to be mined in approximately 10 minutes (as miners join and leave). This mechanism is called ‚Äúthe difficulty adjustment.‚Äù

<div><p align="center"><img src="Images/19.Chapter-9/39.Hash-result-and-the-target-v1.png" width="450"></div>

Let‚Äôs say the target number set by the Bitcoin network is 1,000. The miners would have to use their computational power and energy to search for a block hash (a specific number) that is lower than 1,000. The first miner to find a block hash lower than 1,000 gets to add the new block to the blockchain and is rewarded with bitcoins.

- üí° The difficulty level in Bitcoin mining is a measure of how difficul t it is to find a valid block hash that meets the target set by the network. It is adjusted every 2016 blocks, or roughly every two weeks, to ensure that blocks are added to the blockchain at a c onsistent rate. The difficulty level is expressed as a number, and the higher the difficulty lev el, the more difficult it is to find a valid block hash.

For example, consider two different hashes:
- ‚≠ê **Hash 1:** 0000A1mINgF0RbL0cK5wItHth3hAy5tAcK <br>
   **Difficulty level:** 1
- ‚≠ê **Hash 2:** 00000000A1mINgF0RbL0cK5wItHth3hAy5tAcK <br>
   **Difficulty level:** 2

In this example, Hash 2 has a higher difficulty level than Hash 1 because it is a longer hash with more zeros at the beginning. It would be harder for miners to find Hash 2 because their computers would need to do more work.

- üí° By finding a valid block hash, a miner demonstrates that they ha ve done the work required to add the new block to the blockchain and are paid a reward in bitcoins, plus transaction fees, for their effort. Proof-of-Work (PoW) is the method the Bitcoin network uses to validate transactions and add new blocks to the blockchain.

<br/>

PoW keeps Bitcoin safe by making it difficult for anyone with malicious intentions to take control.

In summary, the tasks of miners consist of:

1. ‚≠ê **Bundling transactions into blocks:** <br>
    While nodes verify newly created transactions that are waiting in ‚Äúthe Mempool,‚Äù miners select a subset of these to include in their candidate block.

2. ‚≠ê **Proof-of-Work:** <br>
    Miners race with each other to find the valid block hash.

3. ‚≠ê **Broadcast valid blocks:** <br>
    After finding the valid blockhash, they propagate the new block to the network.

4. ‚≠ê **Earn Rewards:** <br>
    Lastly, they receive newly created bitcoins and transaction fees for successfully adding the block to the blockchain.

<div><p align="center"><img src="Images/19.Chapter-9/40.Miners-blocks-and-hash-v1.png" width="800"></div>

Multiple miners can work on creating new blocks simultaneously. The first miner to discover a block hash that meets the target set by the network announces it to the network, and the other miners then check the transactions in that miner‚Äôs candidate block to make sure they are valid. If the transactions are indeed valid, the block is added to the blockchain. The other blocks created by the other miners at the time are not added and are discarded. This process helps maintain consensus within the network and prevents double-spending.

- üí° A candidate block is a set of transactions considered for addition to the blockchain but has not been added yet.

<div><p align="center"><img src="Images/19.Chapter-9/41.Miners-blocks-and-hash-2-v1.png" width="830"></div>

<br/>
<br/>

### ***9.4 What is the Mempool?***    

The ‚ÄúMempool‚Äù or Memory Pool is like a waiting room for transactions in the Bitcoin network. When you make a transaction, it is first broadcasted to the Mempool b efore it is verified, selected, and added to the blockchain.

Imagine you are waiting in line at a restaurant. Your name is added to a list of people waiting for a table. When a table becomes available, the host calls your name and seats you. Similarly, a bitcoin transaction is added to the Mempool when it is made and is confi rmed and added to the blockchain when a miner includes it in a block.

<br/>

<div><p align="center"><img src="Images/19.Chapter-9/42.Transactions-in-the-Mempool-v1.png" width="700"></div>

<br/>

**How are transactions verified and added to the Mempool?**
When new transactions are broadcasted to the Bitcoin network, nodes verify these transactions to make sure they are valid and that the funds have not been spent before. Once these transactions are verified, the nodes will add them to their Mempool. The nodes will then share the transactions with other nodes to double-check. Finally, if the majority of nodes agree, the transactions will be made available for miners to select and include them in a block. However, there are several reasons why a transaction might not be confirmed after 72 hours:

1. ‚≠ê **Low transaction fees:** <br>
    Transactions with a low fee may not be processed quickly enough as miners are more likely to choose transactions with higher fees to include in their blocks.

2. ‚≠ê **Network congestion:** <br>
    If the network is congested, there may be a delay in confirmingt ransactions, even if they have a high fee.

3. ‚≠ê **Double spend attempt:** <br>
    If a malicious actor attempts to double spend, their transaction may be rejected by the network.

4. ‚≠ê **Incorrect or incomplete data:** <br>
    If a transaction contains incorrect or incomplete data, it may be rejected by the network.

5. ‚≠ê **Malformed transaction:** <br>
    If a transaction is malformed, it may be rejected by the network.

To avoid having transactions rejected, it‚Äôs recommended to include a fee that is high enough to ensure the transaction is processed in a timely manner and to double check that all the data in the transaction is correct before sending it.

<br/>
<br/>

### _Activity: Mempool_

1. ‚≠ê Scan the following **QR code:**

<div><p align="center"><a rel="Website of -- Mempool" href="https://mempool.space/"><img src="Images/19.Chapter-9/43.Mempool-site-QR-code-v1.png" width="180"></div>

2. ‚≠ê Review the various elements displayed on the page, including the latest blocks, confirmed transactions, the number of transactions, memory usage, and approximate value of the entire block. Answer the questions:
    - ‚≠ê What was the last mined block?
    - ‚≠ê How many transactions were included in that block?
    - ‚≠ê What is the total value traded in bitcoin?
    - ‚≠ê What was the size in megabytes of the block?
    - ‚≠ê How many zeros does the nonce of the block start with?
    - ‚≠ê How much bitcoin did the miner earn in total?
    - ‚≠ê What was the total value of fees received by the miner for adding the transactions to the network?
    - ‚≠ê Choose one of the highest-value transactions in the block. How many Bitcoin addresses was the amount distributed to?

<div><p align="center"><img src="Images/19.Chapter-9/44.Satoshi-is-ready-to-mine-some-Bitcoin-v1.png" width="250"></div>

<br/>
<br/>

### ***9.5 How Bitcoin Transactions Work from Start to Finish***    

1. ‚≠ê Adam wants to send bitcoin to Gerardo. He picks one of his UTXOs, creates a transaction, and adds all necessary details, including the amount of bitcoins he wants to send, Gerardo‚Äôs receiving address, and an above average amount of transaction fees.

2. ‚≠ê After a final check to ensure all details are correct, Adam uses his private key to sign the transaction.

3. ‚≠ê Adam broadcasts the transaction to the Bitcoin network.

<br/>

<div><p align="center"><a rel="Website of -- How Bitcoin transactions work from start to finish" href="https://unchained.com/blog/what-is-a-bitcoin-node/"><img src="Images/19.Chapter-9/45.How-Bitcoin-transactions-work-from-start-to-finish-v1.png" width="750"></div>
<div><p align="center">From: Stevenot, Ted, ‚ÄúWhat is a bitcoin node and how does one work?‚Äù. Unchained <br> Capital, 17, January, 2023 (click on image to go to the website)</p></div>

<br/>

4. ‚≠ê The nodes on the network receive the transaction and verify its validity according to the consensus rules (like checking if Adam‚Äôs signature is valid and if he has sufficient funds to make the transaction).

5. ‚≠ê The transaction is marked valid, and the nodes propagate it to other nodes on the network, adding it to the Mempool.

6. ‚≠ê Since Adam picked a high enough transaction fee, almost all miners include his transaction in their blocks.

7. ‚≠ê Proof-of-Work: Miners race and try to mine their block by finding the valid block hash. One of the miners finds the hash and broadcasts their block to the network.

8. ‚≠ê The nodes receive the newly mined block and verify its validity. This includes validating all transactions within the block and ensuring that the Proof-of-Work requirement is met.

9. ‚≠ê The majority of nodes agree that the block is valid and add it to the blockchain. Gerardo receives the confirmed bitcoins on his receiving address.

10. ‚≠ê As additional blocks are added to the blockchain in the subsequent hour, the number of confirmations for the transaction grows. As the number of confirmations for the transaction increases, Gerardo gains greater confidence in its success and irreversible nature.

<br/>

- üí° In summary, the sender signs the transaction with their private key, the nodes verify the transaction UTXOs, and the miners add the verified transaction to the blockchain. The receiver can then access the bitcoins using their private key. Once a block is mined, all the transactions included in it are considered confirmed and the UTXOs used as inputs in these transactions are considered spent and will not be used again.

<br/>

As we wrap up this chapter, you've gained valuable insights into the fundamental concepts of how Bitcoin works. We've covered essential aspects, from the basics of money to the technical side of Bitcoin technology. Now, let's tie it all together in the next chapter. Chapter 10 awaits, where we'll delve into the significant question: "Why Bitcoin?"
